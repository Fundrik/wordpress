deptrac:
  paths:
    - ./src/php
  layers:
    - name: PluginBootstrap
      collectors:
        - type: class
          value: Fundrik\\WordPress\\Application    

    - name: ContainerBindings
      collectors:
        - type: class
          value: Fundrik\\WordPress\\Infrastructure\\Container\\ServiceBindings

    - name: EventBindings
      collectors:
        - type: class
          value: Fundrik\\WordPress\\Infrastructure\\EventDispatcher\\EventListenerRegistrar

    - name: Laravel
      collectors:
        - type: classLike
          value: Illuminate\\.*

    - name: PsrLogger
      collectors:
        - type: classLike
          value: Psr\\Log\\.*

    - name: WordPressExternal
      collectors:
        - type: classLike
          value: ^wpdb$
        - type: classLike
          value: ^WP_.+$

    - name: Support
      collectors:
        - type: classLike
          value: Fundrik\\(Core|WordPress)\\Support\\.*

    - name: CoreDomain
      collectors:
        - type: classLike
          value: Fundrik\\Core\\.*\\Domain\\.*

    - name: CoreApplication
      collectors:
        - type: classLike
          value: Fundrik\\Core\\.*\\Application\\.*

    - name: Domain
      collectors:
        - type: classLike
          value: Fundrik\\WordPress\\.*\\Domain\\.*

    - name: Application
      collectors:
        - type: classLike
          value: Fundrik\\WordPress\\.*\\Application\\.*

    - name: Infrastructure
      collectors:
      - type: bool
        must:
          - type: classLike
            value: Fundrik\\WordPress\\Infrastructure\\(?!WordPress\\).*
        must_not:
          - type: class
            value: .*(ServiceBindings|EventListenerRegistrar).*

    - name: WordPressInfrastructure
      collectors:
        - type: classLike
          value: Fundrik\\WordPress\\Infrastructure\\WordPress\\.*

  ruleset:
    PluginBootstrap:
      - ContainerBindings
      - Laravel
      - Infrastructure
      - WordPressInfrastructure

    ContainerBindings:
      - PluginBootstrap
      - EventBindings
      - Laravel
      - CoreDomain
      - CoreApplication
      - Domain
      - Application
      - Infrastructure
      - WordPressInfrastructure

    EventBindings:
      - Infrastructure
      - WordPressInfrastructure

    CoreDomain:
      - Support

    CoreApplication:
      - Support
      - CoreDomain

    Domain:
      - Support
      - CoreDomain

    Application:
      - Support
      - Domain
      - CoreApplication
      - CoreDomain

    Infrastructure:
      - Laravel
      - PsrLogger
      - Support
      - Application

    WordPressInfrastructure:
      - PsrLogger
      - PluginBootstrap
      - WordPressExternal
      - Support
      - Application
      - Infrastructure
